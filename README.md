# Сервис автоматического ввода данных

Сервис для автоматического ввода данных в инпут по заранее заданным координатам с использованием robotjs.

## Установка

### Автоматическая установка (рекомендуется)

```bash
npm run install:robotjs
```

Или вручную:
```bash
./install.sh
```

### Ручная установка

**Важно:** robotjs требует нативной компиляции и Python 3.6+.

#### 1. Принять лицензию Xcode (если требуется)
```bash
sudo xcodebuild -license
```

#### 2. Установить Xcode Command Line Tools
```bash
xcode-select --install
```

#### 3. Установить robotjs с указанием Python
```bash
npm install robotjs --python=/usr/bin/python3
```

Или через переменную окружения:
```bash
export PYTHON=/usr/bin/python3
npm install
```

**Если возникают проблемы с установкой, см. [INSTALL.md](./INSTALL.md) для подробных инструкций.**

## Использование

### Базовое использование

```javascript
import InputService from './input-service.js';

const inputService = new InputService();

// Ввод данных по координатам
inputService.inputAtCoordinates(500, 300, 'Ваш текст');
```

### С дополнительными опциями

```javascript
inputService.inputAtCoordinates(500, 300, 'Ваш текст', {
  clearBeforeInput: true,  // Очистить поле перед вводом
  clickDelay: 300,         // Задержка после клика (мс)
  typeDelay: 30            // Задержка между символами (мс)
});
```

### Пошаговое использование

```javascript
// Клик по координатам
inputService.clickAt(500, 300, 200);

// Очистка поля
inputService.clearInput();

// Ввод текста
inputService.typeText('Ваш текст', 50);
```

### Определение координат

Для определения координат инпута используйте:

```javascript
// Переместите мышь на нужное место и запустите:
const pos = inputService.getMousePosition();
console.log(`Координаты: x=${pos.x}, y=${pos.y}`);
```

Или используйте тестовый скрипт:

```bash
npm test
```

## Запуск

```bash
# Основной файл
npm start

# Тестовый файл (для определения координат)
npm test
```

## ⚠️ Важно: Разрешения на macOS

**Если мышь не двигается**, необходимо предоставить разрешения в настройках macOS:

1. **Системные настройки** → **Конфиденциальность и безопасность** → **Управление компьютером**
   - Добавьте ваш терминал (Terminal, iTerm2, WebStorm и т.д.)

2. **Системные настройки** → **Конфиденциальность и безопасность** → **Доступность**
   - Добавьте ваш терминал (Terminal, iTerm2, WebStorm и т.д.)

После добавления разрешений **перезапустите терминал/IDE**.

Проверить разрешения можно командой:
```bash
./check-permissions.sh
```

## Важные замечания

1. **Модальное окно должно быть открыто** перед запуском скрипта
2. **Координаты должны быть точными** - используйте `getMousePosition()` для определения
3. **Инпут должен быть виден** на экране
4. На macOS **обязательно** предоставьте разрешения на доступность (см. выше)

## API

### `inputAtCoordinates(x, y, text, options)`
Полный цикл: клик по координатам и ввод текста.

### `clickAt(x, y, delay)`
Клик по указанным координатам.

### `typeText(text, delay)`
Ввод текста в активное поле.

### `clearInput()`
Очистка поля ввода (выделение всего и удаление).

### `getMousePosition()`
Получение текущей позиции курсора мыши.
